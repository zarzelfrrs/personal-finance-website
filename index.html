<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinTrack - Manajemen Keuangan Pribadi</title>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4f46e5">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    
    <!-- Prevent text selection -->
    <style>
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        input, textarea {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
    </style>
</head>
<body>
    <!-- Mobile Menu -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
    <nav class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <h3><i class="fas fa-bars"></i> Menu</h3>
            <button class="mobile-menu-close" id="mobileMenuClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="mobile-menu-content">
            <a href="#dashboard" class="mobile-menu-item active" data-section="dashboard">
                <i class="fas fa-home"></i> Dashboard
            </a>
            <a href="#transactions" class="mobile-menu-item" data-section="transactions">
                <i class="fas fa-exchange-alt"></i> Transaksi
            </a>
            <a href="#wallets" class="mobile-menu-item" data-section="wallets">
                <i class="fas fa-wallet"></i> Dompet
            </a>
            <a href="#reports" class="mobile-menu-item" data-section="reports">
                <i class="fas fa-chart-pie"></i> Laporan
            </a>
            
            <!-- Mobile Controls -->
            <div class="mobile-controls">
                <button class="mobile-control-btn" id="mobileHideBalance">
                    <i class="fas fa-eye-slash"></i>
                    <span>Sembunyikan Saldo</span>
                </button>
                <button class="mobile-control-btn" id="mobileThemeToggle">
                    <i class="fas fa-moon"></i>
                    <span>Mode Gelap</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <!-- Logo -->
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="logo-text">
                    <h1>FinTrack</h1>
                    <p class="logo-subtitle">Personal Finance</p>
                </div>
            </div>

            <!-- Desktop Navigation -->
            <nav class="desktop-nav">
                <a href="#dashboard" class="nav-item active" data-section="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#transactions" class="nav-item" data-section="transactions">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Transaksi</span>
                </a>
                <a href="#wallets" class="nav-item" data-section="wallets">
                    <i class="fas fa-wallet"></i>
                    <span>Dompet</span>
                </a>
                <a href="#reports" class="nav-item" data-section="reports">
                    <i class="fas fa-chart-pie"></i>
                    <span>Laporan</span>
                </a>
            </nav>

            <!-- Desktop Controls -->
            <div class="desktop-controls">
                <button class="control-btn" id="hideBalanceBtn" title="Sembunyikan Saldo">
                    <i class="fas fa-eye-slash"></i>
                </button>
                <button class="control-btn" id="themeToggleBtn" title="Ubah Tema">
                    <i class="fas fa-moon"></i>
                </button>
            </div>

            <!-- Mobile Menu Button -->
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section active">
                <div class="section-header">
                    <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
                    <div class="date-info" id="currentDate"></div>
                </div>

                <!-- Summary Cards -->
                <div class="summary-cards">
                    <!-- Total Balance -->
                    <div class="summary-card">
                        <div class="card-header">
                            <h3>Total Saldo</h3>
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="card-body">
                            <p class="balance-amount" id="totalBalance">Rp 0</p>
                            <div class="trend-indicator" id="balanceTrend">
                                <i class="fas fa-arrow-up"></i>
                                <span>0% dari bulan lalu</span>
                            </div>
                        </div>
                    </div>

                    <!-- Monthly Income -->
                    <div class="summary-card">
                        <div class="card-header">
                            <h3>Pemasukan Bulan Ini</h3>
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="card-body">
                            <p class="balance-amount" id="monthlyIncome">Rp 0</p>
                            <div class="trend-indicator" id="incomeTrend">
                                <i class="fas fa-arrow-up"></i>
                                <span>0% dari bulan lalu</span>
                            </div>
                        </div>
                    </div>

                    <!-- Monthly Expense -->
                    <div class="summary-card">
                        <div class="card-header">
                            <h3>Pengeluaran Bulan Ini</h3>
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="card-body">
                            <p class="balance-amount" id="monthlyExpense">Rp 0</p>
                            <div class="trend-indicator" id="expenseTrend">
                                <i class="fas fa-arrow-up"></i>
                                <span>0% dari bulan lalu</span>
                            </div>
                        </div>
                    </div>

                    <!-- Budget Status -->
                    <div class="summary-card">
                        <div class="card-header">
                            <h3>Status Budget</h3>
                            <i class="fas fa-percentage"></i>
                        </div>
                        <div class="card-body">
                            <p class="balance-amount" id="budgetStatus">0%</p>
                            <div class="budget-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="budgetProgress"></div>
                                </div>
                                <span id="budgetRemaining">Rp 0 tersisa</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-container">
                    <!-- Monthly Cashflow Chart -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-line"></i> Cashflow Bulanan</h3>
                            <div class="chart-controls">
                                <select id="cashflowPeriod" class="chart-select">
                                    <option value="3">3 Bulan</option>
                                    <option value="6" selected>6 Bulan</option>
                                    <option value="12">12 Bulan</option>
                                </select>
                            </div>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="cashflowChart"></canvas>
                        </div>
                    </div>

                    <!-- Expense Categories Chart -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-pie"></i> Pengeluaran per Kategori</h3>
                            <div class="chart-controls">
                                <select id="categoryPeriod" class="chart-select">
                                    <option value="month" selected>Bulan Ini</option>
                                    <option value="year">Tahun Ini</option>
                                </select>
                            </div>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Transactions -->
                <div class="recent-transactions">
                    <div class="section-header">
                        <h3><i class="fas fa-history"></i> Transaksi Terbaru</h3>
                        <a href="#transactions" class="view-all-link">Lihat Semua <i class="fas fa-arrow-right"></i></a>
                    </div>
                    <div class="transactions-list" id="recentTransactions">
                        <!-- Transactions will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Transactions Section -->
            <section id="transactions" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-exchange-alt"></i> Transaksi</h2>
                    <button class="btn btn-primary" id="addTransactionBtn">
                        <i class="fas fa-plus"></i> Tambah Transaksi
                    </button>
                </div>

                <!-- Transaction Filters -->
                <div class="filters">
                    <div class="filter-group">
                        <label for="filterType"><i class="fas fa-filter"></i> Tipe:</label>
                        <select id="filterType" class="filter-select">
                            <option value="all">Semua</option>
                            <option value="income">Pemasukan</option>
                            <option value="expense">Pengeluaran</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="filterCategory"><i class="fas fa-tag"></i> Kategori:</label>
                        <select id="filterCategory" class="filter-select">
                            <option value="all">Semua Kategori</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="filterWallet"><i class="fas fa-wallet"></i> Dompet:</label>
                        <select id="filterWallet" class="filter-select">
                            <option value="all">Semua Dompet</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="filterDate"><i class="fas fa-calendar"></i> Periode:</label>
                        <select id="filterDate" class="filter-select">
                            <option value="all">Semua Waktu</option>
                            <option value="today">Hari Ini</option>
                            <option value="week">Minggu Ini</option>
                            <option value="month" selected>Bulan Ini</option>
                            <option value="year">Tahun Ini</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary" id="clearFiltersBtn">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                </div>

                <!-- Transactions Table -->
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Deskripsi</th>
                                <th>Kategori</th>
                                <th>Tipe</th>
                                <th>Dompet</th>
                                <th>Jumlah</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsTable">
                            <!-- Transactions will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                <div class="pagination" id="transactionsPagination">
                    <!-- Pagination will be loaded here -->
                </div>
            </section>

            <!-- Wallets Section -->
            <section id="wallets" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-wallet"></i> Dompet</h2>
                    <button class="btn btn-primary" id="addWalletBtn">
                        <i class="fas fa-plus"></i> Tambah Dompet
                    </button>
                </div>

                <!-- Wallets Grid -->
                <div class="wallets-grid" id="walletsGrid">
                    <!-- Wallets will be loaded here -->
                </div>

                <!-- Wallet Transfer -->
                <div class="wallet-transfer">
                    <h3><i class="fas fa-exchange-alt"></i> Transfer Antar Dompet</h3>
                    <form id="transferForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="transferFrom">Dari Dompet:</label>
                                <select id="transferFrom" class="form-select" required>
                                    <option value="">Pilih Dompet</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="transferTo">Ke Dompet:</label>
                                <select id="transferTo" class="form-select" required>
                                    <option value="">Pilih Dompet</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="transferAmount">Jumlah (Rp):</label>
                                <input type="number" id="transferAmount" class="form-input" min="1" required placeholder="0">
                            </div>
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-paper-plane"></i> Transfer
                                </button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="transferNote">Catatan:</label>
                            <input type="text" id="transferNote" class="form-input" placeholder="Deskripsi transfer">
                        </div>
                    </form>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-chart-pie"></i> Laporan Keuangan</h2>
                    <div class="report-actions">
                        <button class="btn btn-secondary" id="exportPDFBtn">
                            <i class="fas fa-file-pdf"></i> Export PDF
                        </button>
                        <button class="btn btn-secondary" id="exportExcelBtn">
                            <i class="fas fa-file-excel"></i> Export Excel
                        </button>
                    </div>
                </div>

                <!-- Report Filters -->
                <div class="report-filters">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label for="reportType">Jenis Laporan:</label>
                            <select id="reportType" class="filter-select">
                                <option value="daily">Harian</option>
                                <option value="weekly">Mingguan</option>
                                <option value="monthly" selected>Bulanan</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="reportDate">Periode:</label>
                            <input type="month" id="reportDate" class="date-input" value="">
                        </div>
                        <div class="filter-group">
                            <label for="reportCategory">Kategori:</label>
                            <select id="reportCategory" class="filter-select">
                                <option value="all">Semua Kategori</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="reportWallet">Dompet:</label>
                            <select id="reportWallet" class="filter-select">
                                <option value="all">Semua Dompet</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" id="generateReportBtn">
                            <i class="fas fa-chart-bar"></i> Generate Laporan
                        </button>
                    </div>
                </div>

                <!-- Report Results -->
                <div class="report-results">
                    <div class="report-summary" id="reportSummary">
                        <!-- Report summary will be loaded here -->
                    </div>
                    <div class="report-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Tanggal</th>
                                    <th>Deskripsi</th>
                                    <th>Kategori</th>
                                    <th>Tipe</th>
                                    <th>Dompet</th>
                                    <th>Jumlah</th>
                                </tr>
                            </thead>
                            <tbody id="reportTable">
                                <!-- Report data will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Modals -->
    <!-- Add Transaction Modal -->
    <div class="modal" id="transactionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus"></i> Tambah Transaksi</h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="transactionForm">
                <div class="form-group">
                    <label for="transType">Tipe Transaksi *</label>
                    <div class="type-selector">
                        <button type="button" class="type-btn income active" data-type="income">
                            <i class="fas fa-arrow-up"></i> Pemasukan
                        </button>
                        <button type="button" class="type-btn expense" data-type="expense">
                            <i class="fas fa-arrow-down"></i> Pengeluaran
                        </button>
                    </div>
                    <input type="hidden" id="transType" value="income" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="transAmount">Jumlah (Rp) *</label>
                        <input type="number" id="transAmount" class="form-input" min="1" required placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="transDate">Tanggal *</label>
                        <input type="date" id="transDate" class="form-input" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="transDescription">Deskripsi *</label>
                    <input type="text" id="transDescription" class="form-input" required placeholder="Contoh: Gaji bulanan">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="transCategory">Kategori *</label>
                        <select id="transCategory" class="form-select" required>
                            <option value="">Pilih Kategori</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="transWallet">Dompet *</label>
                        <select id="transWallet" class="form-select" required>
                            <option value="">Pilih Dompet</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="transNotes">Catatan (Opsional)</label>
                    <textarea id="transNotes" class="form-textarea" rows="2" placeholder="Catatan tambahan"></textarea>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary modal-close">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan Transaksi</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Wallet Modal -->
    <div class="modal" id="walletModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-wallet"></i> <span id="walletModalTitle">Tambah Dompet</span></h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="walletForm">
                <input type="hidden" id="walletId">
                
                <div class="form-group">
                    <label for="walletName">Nama Dompet *</label>
                    <input type="text" id="walletName" class="form-input" required placeholder="Contoh: Dompet Utama">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="walletType">Tipe Dompet *</label>
                        <select id="walletType" class="form-select" required>
                            <option value="cash">Cash (Tunai)</option>
                            <option value="bank">Bank</option>
                            <option value="ewallet">E-Wallet</option>
                            <option value="savings">Tabungan</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="walletBalance">Saldo Awal *</label>
                        <input type="number" id="walletBalance" class="form-input" min="0" value="0" required placeholder="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="walletColor">Warna Dompet</label>
                    <div class="color-picker" id="colorPicker">
                        <!-- Colors will be added by JavaScript -->
                    </div>
                    <input type="hidden" id="selectedColor" value="#4f46e5">
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary modal-close">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan Dompet</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-exclamation-triangle"></i> Konfirmasi</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Apakah Anda yakin?</p>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary modal-close">Batal</button>
                <button type="button" class="btn btn-danger" id="confirmDelete">Hapus</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-chart-line"></i> FinTrack</h4>
                    <p>Manajemen keuangan pribadi yang sederhana dan efektif</p>
                </div>
                <div class="footer-section">
                    <h4>Fitur</h4>
                    <ul>
                        <li><i class="fas fa-check"></i> Multi Dompet</li>
                        <li><i class="fas fa-check"></i> Laporan Lengkap</li>
                        <li><i class="fas fa-check"></i> Export Data</li>
                        <li><i class="fas fa-check"></i> Grafik Interaktif</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Platform</h4>
                    <ul>
                        <li><i class="fas fa-desktop"></i> Desktop</li>
                        <li><i class="fas fa-mobile-alt"></i> Mobile</li>
                        <li><i class="fas fa-moon"></i> Dark Mode</li>
                        <li><i class="fas fa-shield-alt"></i> Privasi</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 FinTrack - Untuk penggunaan pribadi</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript Files -->
    <script src="js/storage.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/wallet.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>

    <!-- Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(() => console.log('Service Worker terdaftar'))
                .catch(err => console.log('Service Worker gagal:', err));
        }
    </script>
</body>
</html>